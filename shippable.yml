language: python

python:
  - 2.7

services:
  - mysql

env:
  global:
    - GAE_DIR=/tmp/gae
    # the following secure variable is the json key for the app engine project's service account
    - secure: QYN7mZrXlO4kU4zm4IvncSUFRWJLlgiRyPJwI30N+Ynallr9R3T+kvxQcCxCEWvvN7i3oK89RHWpePwIpeOXZVJc2vbH8irxrFxZ8sb5/MiTdbo88NpmaYrvMn20DsdNYWwLXxemofv3d1m/pLwfofRIocp1fuOhdDCgqWh3u2cJcUfGJrKwsHhqRobRAdetYwtLA5Gm0FS+cjHajVm+iTO5cxZRz6tBYH7UJGtvU7nHZXePISP/rXGKHrlD6eLAXND4zgmedNdEhHtlwjvUO1PaUADn5HxgFR4LML8yxYgFmL2Vv2pRHCTw3/nh1g0xzzEaIhV92zepIYYmQMQL5XCyQ5uuJOiTpO91sQ+53Xl/DUBFbNu4kShKFks64qW9e64awMZOISB1pcm4eUlPQf6WoO9MKG3KPb4cmkhXgrUNj5CfFq6A+cQkwR6u82JnDYWD77u1C3OaP3uc5FBwbeDHRxgto323sXHUnhuiGhaauiazUMEoYegRUAadnUAC8UxE40kPWO3hzovtQXIi+JE/uW35nGv4wp8xeqp5X7rQXsvWZ9Hm5Dw0JSt5gPJV8azCI4CoGWQlcIBvMyUSb+n3YPPoioRBXKg2SWYS5Gr4aQ8q1LvfXU5jCqSHq4SxgDnJWRAb3C/SxU4KYDOMZ4t5EHa/e6D79LnFfSzoe68lscKNv7VvOfO6W5bGMSDpVTD6FGzDjfEVbFrEtFQZceftEqhvuXZF7Wj4kQmMsodGR9w8xxaRzP22SeVHRXQ2L5XuaA+TDI3uNaznKnTlEnaIeLNt9SXAmYBQ/4RbXeHIn6bEfCN/IhZCys96iaQ1hhVNcxeC9nZuKQLNhlTijvoZLGTCPyGYkHaAd6rrK9OrkpD/1kJPeaQGIE1AF3L00v5U2qgWt6sFzz8oWiAekMIXbTURVwZ6Yc8Se3by1NVF+gMWeLeotWE6DEbBhfkKxP9UcdzVvL0o7L7eR60QkFgN6huw/PuWl/+Abwd2cQdZrMv7nGIEKvDRxCPV8W5OeQHwEZtOPNdXVIWdIGD12BVdM2iDB7jpwdBnuVnkNYcoqhbagbWPpl7sW3YNrVIW0EA8RqfT4ydCLEZiuD14NNkFeel2cjP9tnqYNJ5VO72seECaFegZbXohkii1iOwuw1TviClyEpZ7FThvqD+jjWWp6eCK3TbMcLcOIXu4Z7roe/zG4jSVPn+p5GaSAffVrVYqllb89TuBlndvuWlJ4Xu2NO+I7u+FrAsGfmIxv3Hxk77Pr6SI7Z/H0fH2I1NFTnulCrwOuldnRXCfl1oUcBkTtI+VmyoKvhNBBHvrJ9PRB06SimOeimVQS4pW7K2rrr2HdNuuzWToe8TqNoko/oOlb1ovOGGmc2s1QOYTm+o0Vdk4OmhJPi+N3okcDlNPWQtYwI1vplbFT5R0ltHO5LTRBef/yCBgEnoJJtuGPk/5cBPmOFdf6ul47AH+Qxyy+Jx4SwoqhHJbuY0vezc14tSLJxo/U+nZOw4e/ElhXP55EMNzUwy8YcNr4Re4bVXGSHO872SyOnuCFFLI/hGdX0dsgC8v6xVdltX9+VEnp7d734ZZ28uwi4eBgvIpXQ/G9w+zdLlz5BlHV27VAPNLs+KUYQrXaVTy1kfQiij3+IDHZE5EW7BBCenPidAZdRrVaj0Oyv2GO9bD4IFuavGvyl/CEEaItkYHTkeEIuERk9YARv0euYF4HDgrgmZJr3y+E2WeXWqLmGCJ8nOnm97S0Mk84t/yS2MDiOTUiySCpjO7or2pmw0obizs5apASNWfOT0B07b83tL7/XePLkFwX2QQ1VLE7Age7m5j8hczTv8KTDgYp5hrn7hEmhOkt2FH613jiB+Am7+SzukmzDfqRhqLDV+TzZjpW1joYY4YTACHiwX9V60i/pcgkh1xvvMExWc1+fvGnjLIxslhmG92LSlqBlj7QVH8ToUytry2qtlUK9RHwwCt+OIICnjWqWoCJJPMUx9dex8EIp91Al8jfvA7FDZSd7SXlyl8x1aY5nY3ap2YZ0lfoWJOGL70vnTfSioUu1Yy3NiH9cqlwicQMgvKtt1VbziAzxDqV/e4ZH8i/b/yDdpRlSG0FNnhs9ExybupPqwmUErYUXGDdoVJ+1mpoe+TMZbNkJOFk353SB5nkYRH7kcfXa0DTJqfOI6bN0LwLmX1YwkB4tdwSW0U2flRo1rk8oHzzPe9cnC/YsT/nzxENX4+qLuYKAHswUVLVADh4ppZmd4P/zSTIfn/SMxlKuYvc8eSlhU0cs7j6BvVfEPwCB/NJi5JvuLEazThGre6HC21DHqJTP2sA1sb1nEhRJIwS8UJT1Veycq7b0hisRrICb/bDebJf7R6yvWAx7Ax+cVsmuxR85ZYSm1CZ3XX8H8Fo13bloXd0pEqCepB101oOVacu2LZO1oA2lg5IlxUgGVkpy/htJQHB799MEAzmiFTAfwbLvKB/hwCFbn+yPZ3IGryyZAB8L9qOaeE3ILBMw+FqAUPrkOjmQT+JUreogS1pFP+vug+A0JPThu4Yc6Y1T4udwJYLN0z8Upj9CWfevfiRK+CBcLQLUkzlE39O2/H9xVrDz8h0ql1gqdNzqNhWn3WWHRbWgU2OU8GGw0t5RZOMJPL8TrGdNO/baStg+Rm5wAVZMbeC3quFhsLngPFYfQAvVQfUvzn+h9p8at2gX1WZDgWqnKuH+Ge22ZnRDDET3chIN1n8uGw2J4MFbw44cKzo65PTyEZPypFuesMnSbHQk8VBI4m9WubWsADR2/nzLeCBY7KdFK7VFxcGbAb2rDxIkYnhH4GQ6amMApqzP8EV8Gav11mHvE97hc2yElihuWuaHcPQUL/GMb1t302N6u4M5tTdrC/qcGxsVZIm10Frb6KDI164GZWsG+eSQVbRIiMBNvJmXvw2WH4PGU4HckzR6xrpirCo/6CRnjKwYN/kFiwuH+RlHM4ovtET9FPLW/2ZVhAPu557QAqf07xhgw4+OKzF5cF7k1VYu1JsRICDSCvOtJgaIGOIQHyld0dHjH22OG6V3595+Xv18Xiz5CivkYSA3n6YPZwnTeD5EXCGEQ88dgAWTcyxMRJunkgJlt4yR3UArA9EbXo6pPEFdBrAAy8eLENFj/JzR9w15iaSiN+KGSI68urnwS1lhM3OzJEKispv2WABzwDnPgGw8eGBnU6H3Vl+8M74dOaqsx1uosv5ZFhGd/HLmJTaRrr3vj5bjHdbpTu60Asi11n0aZV3IuXJ9EX1TG7SbZhIi1hujl9KjBLyiG/LJV1+hzJDTCLCWhqwR3TtAiLZCsGDK34/oe9KAmzhMIwX1NXOAlCYZmZkeztSs7ESEkxUfmIcCvRCqJz+xWm/vhSGmSjAd4tP6Cz/8iU8fjqI7PerWRMgaivZC9Q5jN+9Xtmpok7LbNBgh5eTCVhJLuWRmFqw6PftwcRc8VwWca4txddEY5VjRZDyu+NzxV7M8juaSXjhio2r6QIexsB2elTLgdqnzjBiZOi4RVjrOGXQDmBoy8wIiK0c93YB6qkDxb0stcZc++UY6Mfjw6eNcNwyZJyy7tqi+MgPY12Zwh3Oruc73CXcBsG9L+u3M0YQV53yTMfdEUsL7kJa2HZzOnz32vmyQo3fUMqYYRIRbFfCDc8Z4YLs5OlJheYvM2u5nCu2ec3+9csCBJS4Dy91MCzERwcC6fyQSb0JPYWq7J0K9/0fWAfo+N0ZU6uHpaVEqD6nf50XPN1FgT0Qrmw10RqjhuqxP0dRjZCcWsvM7FLcXIxsN4uCnovYfYsg9XAPjguQf4K2uuLPtvSo13fdpxk83wkqQYdEz/gH+iIya+dOEGwdfwnX1hYSmOvp2DleF84gxQzBh0z8dWG5io7kOLFGJZd4J62KC0b2jpboHeNqLOimtNs7J/0DC4NpONE2GKTeij1xe9Ca2V1CUpQHePKgQFkKjFZPKnTE6i0teOVVsgJ69CkMTTPfltoWo+rt6iw8AdETBnaSsY89SEZN6uZIrlNtOdiww9TWk4d5mu19TPubMrSbyIfArG2hIZwYhlaEkTW4+I4eRdYMMFgzXzBPk0V1ex5MK8hs0WNZL8D

build:
  ci:
    - echo $GAE_DIR
    # - >
    #   test -e $GAE_DIR ||
    #   (mkdir -p $GAE_DIR &&
    #   wget https://storage.googleapis.com/appengine-sdks/featured/google_appengine_1.9.35.zip -q -O /tmp/gae.zip &&
    #   unzip /tmp/gae.zip -d $GAE_DIR)
    - pip install -r requirements.txt
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - coverage run manage.py test
  on_success:
    - echo 'yay'
    # - echo "$GAE_PASSWORD" | $GAE_DIR/google_appengine/appcfg.py -e "$EMAIL" -A "testgkeproject-1181" --noisy list_versions
    - supress=$(echo $SERVICE_ACCOUNT_KEY > /tmp/key.json)
    - gcloud -q auth activate-service-account --verbosity=debug --key-file /tmp/key.json
    - gcloud config set project testgkeproject-1181
    - gcloud config list
    - sudo apt-get install tree
    - tree $SHIPPABLE_REPO_DIR
    - gcloud preview app deploy $SHIPPABLE_REPO_DIR/app.yaml



